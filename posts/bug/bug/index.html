<!DOCTYPE html>
<html class="nojs" lang="zh-cn" dir="ltr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>bug 记录 – ZhengPengDe Blog</title>
<meta name="description" content="bug 记录">
<meta name="created" content="2015-07-01T09:00:00+0000">
<meta name="modified" content="2023-06-01T09:00:00+0000">
<meta name="author" content="zhengpengde">

<meta property="og:site_name" content="ZhengPengDe Blog">
<meta property="og:title" content="bug 记录">
<meta property="og:url" content="https://847850277.github.io/posts/bug/bug/">
<meta property="og:type" content="article">

<meta name="generator" content="Hugo 0.112.5">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="theme-color" content="#ffffff">


<link rel="canonical" href="https://847850277.github.io/posts/bug/bug/">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">

<link rel="stylesheet" href="/css/styles.f5f42549a2ff6655f6895613fdad4142b37562f0565fa9def394a039f13e54fa.css">
<link rel="stylesheet" href="/css/print.31e2819287afc91406f2fd43d21a8ba4a0cdfc272e439c90db0c6e47efc7c346.css" media="print">

<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "WebPage",
    "headline": "bug 记录",
    "datePublished": "2015-07-01T09:00:00Z",
    "dateModified": "2023-06-01T09:00:00Z",
    "url" : "https://847850277.github.io/posts/bug/bug/",
    "description": "bug 记录",
    "keywords": ["bug"],
    "author": {
      "@type": "Person",
      "name": "zhengpengde"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://847850277.github.io/"
    },
    "publisher": {
      "@type": "Organization",
      "name": "ZhengPengDe Blog",
      "url": "https://847850277.github.io/"
    }
  }
</script>

<script src="/js/script-early.min.21220209af63c496c7531316922ef9a4548661be9388bbcd1f9899bb0b842b21.js"></script>

<script defer src="/js/script.min.f8f04035e9a9424ebc267c1a5fdb513d79b611a04b85cab2ac414d091ac9e94c.js"></script>



</head>

<body class="single-page">
<div class="page layout__page">
<header class="header layout__header mb--m">
<a href="/" title="Home" rel="home" class="header__logo">
<img src="/images/logo.png" alt="Home" class="header__logo-image">
</a>
<h1 class="header__site-name">
<a href="/" title="Home" class="header__site-link" rel="home"><span>ZhengPengDe Blog</span></a>
</h1>
<div class="region header__region">
</div>
</header>

<nav class="main-menu layout__navigation" aria-label="Main menu">
<ul class="navbar">
<li><a href="/">Home</a></li>
<li><a href="/posts/" aria-current="page">Posts</a></li>
</ul>
</nav>
<main class="main layout__main">
<article class="single-view single-view--posts">
<header>
<h1 class="title ">bug 记录</h1>
<div class="tags meta">
Tags:
<ul>
<li><a href="https://847850277.github.io/tags/bug/">bug</a></li>
</ul>
</div>
</header>
<div class="content">
<h1 id="bug清单表格">bug清单表格</h1>
<h2 id="1springboot上传文件报流关闭错误">1、springboot上传文件，报流关闭错误</h2>
<ul>
<li>现象 : <code>springboot上传文件，报流关闭错误</code></li>
<li>原因 : 项目中增加了全局的GlobalWebAppConfig，其中的配置导致流关闭失效</li>
<li>解决方式 : 移除@EnableWebMvc注解</li>
<li>过程总结 :
<ul>
<li><code>本地复现</code></li>
<li><code>定位问题点 （移除pom），注释依赖</code></li>
<li><code>确定问题点确实是新增配置</code></li>
<li><code>网上搜索解决方式</code></li>
</ul>
</li>
<li>记录时间 : 2021-08-21</li>
</ul>
<h2 id="2某些sql会在limit后追加一个limit导致查询sql报错">2、某些sql会在limit后追加一个limit，导致查询sql报错</h2>
<ul>
<li>现象 : <code>某些sql会在limit后追加一个limit，导致查询sql报错</code></li>
<li>原因 : <code>PageHelper 非安全调用方式，项目中使用方式为PageHelper.startPage,此种方式背后实现原理为： ThreadLocal设置线程局部变量，tomcat线程次会缓存请求，可能导致threadlocal中的线程变量被其他线程访问到</code></li>
<li>解决方式 : <code>springmvc层增加全局的拦截器， 然后手动移除一下pageHelper的变量</code></li>
<li>过程总结 :
<ul>
<li><code>定位问题</code></li>
<li><code>网上搜索确实发现limit可能会是pagehelper导致</code></li>
<li><code>再次定位threadlocal设置变量，设置tomcat工作线程设置为1个</code></li>
<li><code>本地手写分页复现场景，分页参数设置，未查询数据库，手动触发报错</code></li>
<li><code>增加全局分页拦截器解决</code></li>
</ul>
</li>
<li>记录时间 : 2021-08-21</li>
</ul>
<h2 id="3请求接口返回90044错误">3、请求接口，返回90044错误</h2>
<ul>
<li>现象 : <code>请求接口，返回90044错误</code></li>
<li>原因 : <code>2.0网关配置中，只建立了bi的服务，在角色那一栏并未配置bi相关的服务</code></li>
<li>解决方式 : <code>2.0网关配置erp-api的相关权限</code>
<ul>
<li>1、定位问题9004</li>
<li>2、查询9004为请求接口超出授权范围</li>
<li>3、访问灰度复现出改问题</li>
</ul>
</li>
<li>过程总结 :
<ul>
<li><code>定位问题9004</code></li>
<li><code>查询9004为请求接口超出授权范围</code></li>
<li><code>访问灰度复现出改问题</code></li>
<li><code>找运维老师确认2.0网关的配置问题</code></li>
<li><code>确认配置问题、增加配置</code></li>
</ul>
</li>
<li>记录时间 : 2021-08-23</li>
</ul>
<h2 id="4小程序获取手机号授权并未生成响应的学员记录">4、小程序获取手机号授权，并未生成响应的学员记录</h2>
<ul>
<li>现象 : <code>小程序获取手机号授权，并未生成响应的学员记录</code></li>
<li>原因 : <code>营销服务调用crm服务，crm服务新增授权类型客户的时候没有写入电话字段</code></li>
<li>解决方式 : <code>入口出增加电话字段</code></li>
<li>过程总结 :
<ul>
<li><code>httplog寻找入参数， ```sql select * from </code>alc-http-log<code>.http_log where </code>system<code> = 'marketing-center' and url = '/recruitMini/mobile' and request_time &gt;= '20201-08-23 18:40:00'</code></li>
<li><code>入参拿着本地调试</code></li>
<li><code>定位问题为crm写入处</code></li>
<li><code>crm处写入值</code></li>
</ul>
</li>
<li>记录时间 : 2021-08-25</li>
</ul>
<h2 id="5crm服务导入数据特定的获客渠道异界交换才能够导入">5、crm服务导入数据、特定的获客渠道（异界交换）才能够导入</h2>
<ul>
<li>现象 : <code>crm服务导入数据、特定的获客渠道（异界交换）才能够导入</code></li>
<li>原因 : <code>crm调用基础字典服务获取获取渠道字典只能获取parentId不为空的获取渠道、 实际的数据有很多条</code></li>
<li>解决方式 : <code>获取字典处调整为获取所有的获客渠道， crm也调用获取所有的获客渠道</code></li>
<li>过程总结 :
<ul>
<li><code>下载导入模版</code></li>
<li><code>启动对应环境参数的项目、复现问题</code></li>
<li><code>定位问题为获取字典处，未获取到完全的获客渠道</code></li>
</ul>
</li>
<li>记录时间 : 2021-08-25</li>
</ul>
<h2 id="6支付成功后在crm的h5页面填入分单的数据结果分单后的比例并没有按对应比例保存">6、支付成功后，在crm的h5页面填入分单的数据、结果分单后的比例并没有按对应比例保存</h2>
<ul>
<li>现象 : <code>支付成功后，在crm的h5页面填入分单的数据、结果分单后的比例并没有按对应比例保存</code></li>
<li>原因 : <code>历史设计如此、在填写分单业绩处逻辑为判断是否有无生成业绩， 若是业绩未生成，其对应填写的比例也不会保存</code></li>
<li>解决方式 : <code>无</code></li>
<li>过程总结 :
<ul>
<li><code>本地启动程序</code></li>
<li><code>复现该问题</code></li>
<li><code>读历史的代码，发现历史代码也是要生成业绩后才会记录分单的比例</code></li>
</ul>
</li>
<li>记录时间 : 2021-08-25</li>
</ul>

</div>

<div class="content content--bottom">
<div class="content-dates meta">
Updated: 1 June, 2023<br>
Created: 1 July, 2015
</div>
</div>
</article>
</main>


<footer class="footer layout__footer mt--l">
<p><span>© ZhengPengDe Blog</span></p>


</footer>

</div>
</body>
</html>
